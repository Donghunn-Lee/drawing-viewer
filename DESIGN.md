# Design.md

본 문서는 도면 탐색 UI를 설계하고 구현하는 과정에서
설계 의도와 주요 판단 기준을 정리한 문서입니다.

작성자 : 이동훈

---

## 1. 데이터 분석: metadata.json 해석

metadata.json을 처음 살펴봤을 때,
이 데이터는 단순한 트리 구조라기보다는
**계층 구조를 기본으로 하면서, 공종·구역·리비전처럼 서로 교차되는 선택 축과
시간(리비전), 공간(도면 영역) 개념이 함께 얽혀 있는 데이터**라고 이해했습니다.

Drawing을 기준으로 공종(Discipline), 구역(Region), 리비전(Revision)이 단계적으로 연결되어 있고,
사용자는 이 구조를 따라 선택을 좁혀가며 현재 보고자 하는 도면 상태에 도달하게 됩니다.

처음에는 건설 도메인 특유의 복잡함이라고 느꼈지만,
조금 더 데이터를 뜯어보니 본질적으로는
**여러 기준을 따라 대상을 점점 좁혀가는 일반적인 탐색 문제**에 가깝다고 생각하게 되었습니다.

예를 들어 마트 도메인이라면
상품이 있고, 이를 카테고리, 제조사, 버전, 진열 위치 등의 기준으로 필터링하듯이,
이 과제의 데이터 역시 도면을 하나의 “대상”으로 두고
공종, 구역, 리비전을 기준으로 선택을 교차해 나가는 구조라고 보았습니다.

이런 관점에서 데이터를 그대로 나열하기보다는,
**현재 선택 상태를 기준으로 의미 있는 선택지와 정보만을 보여주는 방식**이 더 적절하다고 판단했습니다.

linked-list나 그래프 구조처럼
관계 중심의 표현 방식도 고려해볼 수는 있었지만,
본 과제의 범위와 사용 흐름을 고려했을 때는
계층을 따라 선택을 좁혀가는 방식이 사용자 입장에서 가장 직관적이라고 생각했습니다.

---

## 2. 접근 방식: 과제 진행 순서

처음 접하는 도메인과 데이터 구조였기 때문에,
처음부터 완성형을 목표로 하기보다는
**일단 전체 흐름이 보이는 최소한의 형태를 빠르게 만들어보는 것**을 우선 목표로 삼았습니다.

먼저 도면을 화면에 표시할 수 있는 가장 기본적인 뷰어를 만들고,
그 위에 메타데이터를 어떤 순서와 기준으로 연결해야 할지를 하나씩 정리해 나갔습니다.

과제의 핵심이 단순한 도면 표시가 아니라
도면을 **찾고**, **비교하고**, **현재 상태를 인식하는 것**이라고 생각했기 때문에,
메타데이터를 그대로 UI에 얹기보다는
선택 상태를 정규화하고 selector를 통해 필요한 정보만 파생시키는 구조로 설계했습니다.

기본적인 흐름이 잡힌 이후에는
도면 표시 영역을 충분히 확보하는 것이 중요하다고 판단했고,
이를 위해 레이아웃을 다시 고민하게 되었습니다.

도면 표시 영역은 좌표 기반 정보(overlay, polygon)를 다루는 기능이 많았기 때문에,
DOM보다는 Canvas가 더 적합하다고 판단하여
Canvas를 중심으로 뷰어를 설계했습니다.

---

## 3. UI 설계 결정

### 레이아웃 선택 이유

UI를 설계하면서 가장 중요하게 생각한 기준은 다음 세 가지였습니다.

- 도면 탐색 과정이 복잡하지 않을 것
- 현재 어떤 도면 상태를 보고 있는지 쉽게 인식할 수 있을 것
- 도면 자체를 최대한 크게 볼 수 있을 것

모든 요소를 항상 동시에 보여주는 방식보다는,
**상황에 따라 역할이 분리되는 구조가 더 현실적**이라고 생각했습니다.

이에 따라 선택 영역과 컨텍스트 정보를 하나의 패널로 구성하고,
해당 패널을 열고 닫을 수 있도록 하여
도면에 집중하고 싶을 때는 화면을 최대한 활용할 수 있도록 설계했습니다.

이 방식이 항상 최선이라고 생각하지는 않지만,
주어진 시간과 과제 범위 내에서는
탐색, 정보 인식, 도면 표시 사이의 균형을 가장 잘 맞출 수 있는 선택이라고 판단했습니다.

### 고려했던 다른 방식들

읽기 쉬운 넓은 패널을 항상 고정하는 방식도 고려해보았지만,
옵션 선택이 용이하고 정보가 효과적으로 전달되지만
도면 표시 영역이 계속 제한된다는 점이 아쉬웠습니다.

반대로 패널을 더 세분화하고, 좁은 영역에서 내용을 바꿔가며 선택하는 방식은
도면은 최대한으로 크게 살펴볼 수 있겠으나
선택 영역의 렌더링 조건이 복잡해지는 동시에 옵션 변경에 불편함이 크다고 판단하여
이번 과제에서는 선택하지 않았습니다.

---

## 4. 기술 선택

상태 관리는 과제 범위를 고려했을 때
전역 상태 관리 라이브러리가 필요할 정도로 복잡하지 않다고 판단했습니다.
React의 기본 상태 관리와 selector 중심 구조만으로도 충분히 관리 가능하다고 보았습니다.

스타일링의 경우, 최근에는 Tailwind를 주로 사용해왔지만
이번 과제에서는 레이아웃 구조와 컴포넌트 책임이 코드상에서 드러나는 것이 더 중요하다고 느껴
CSS Module을 선택했습니다.

---

## 5. 어려웠던 점 및 개선하고 싶은 부분

### 이미지 오버레이 정합성 문제

오버레이 기능을 구현하면서,
일부 도면에서 이미지 정합이 맞지 않는 문제가 가장 오래 고민하게 만든 부분이었습니다.

여러 시도를 해본 결과,

이 문제는 렌더링 로직의 오류라기보다는
도면 이미지 해상도와 포맷(PNG/JPEG)의 혼재,
도면 프레임과 여백 구조 차이에서 비롯된 문제에 가깝다고 판단했습니다.

임의 보정을 통해 “맞아 보이게” 만드는 방법도 가능했지만,
이는 근거 없는 값에 의존하게 되고
다른 도면이나 확장 상황에서는 오히려 문제가 될 수 있다고 생각했습니다.

그래서 정합성을 확신할 수 없는 도면의 경우에는
오버레이 기능을 비활성화하는 방향을 선택했습니다.
기능을 줄이기보다는, 잘못된 정보를 보여주지 않는 것이 더 중요하다고 판단했습니다.

### 컨트롤 패널 토글 시 flicker 현상

컨트롤 패널을 열고 닫는 과정에서 Canvas 영역이 재배치되며
아주 짧은 flicker 현상이 발생합니다.

레이아웃 전환과 Canvas resize 타이밍이 맞물린 구조적인 문제로 보였고,
시간이 더 주어진다면
컨트롤 패널 레이아웃 구조 자체를 단순화 하거나
Canvas resize를 명시적으로 제어하는 방식으로 개선해보고 싶습니다.

### 구현하지 못한 기능

- 두 도면을 동시에 비교하는 듀얼 뷰어
- 공종이나 리비전 간 자유로운 오버레이 비교

이 기능들은 기한 내 완전히 구현할 여력이 부족했던 것도 사실이나,
실제 현업에서 어떤 비교가 의미 있는지에 대한 확신이 부족해
이번 과제에서는 보류하게 되었습니다.

---

## 마무리

이번 과제에서는 모든 기능을 구현하는 것보다,
**데이터의 구조와 한계를 이해하고, 그 안에서 신뢰할 수 있는 UX를 만드는 과정**에 더 집중했습니다.

완성도보다는
어떤 문제를 인식했고, 그에 대해 어떤 선택을 했는지를
솔직하게 정리하는 것을 목표로 했습니다.
